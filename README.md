# FastAPI Domain-Driven Design chat

### Логіка системи:

* _Telegram бот отримує повідомлення від користувача._
* _Бот відправляє ці повідомлення у Kafka, яка виконує роль шини повідомлень._
* _Веб-сокет підключення у веб-інтерфейсі дозволяє в реальному часі передавати повідомлення від Kafka до клієнта у браузері._
* _Kafka виступає як проміжний сервер для зберігання та розповсюдження повідомлень у різні частини системи._

### Детальний процес логіки системи:

1. #### Telegram бот
   * Користувач надсилає повідомлення в Telegram бот.
   * Бот отримує це повідомлення і відправляє його до Kafka через API.
   * Kafka приймає повідомлення і публікує його в певний топік (наприклад, "telegram-messages").

2. #### Kafka (шина повідомлень)
   * Kafka зберігає кожне повідомлення в топіку "telegram-messages".
   * Система, яка підключена до цього топіка, може підписатися на нього і отримувати повідомлення в режимі реального часу або коли вони з'являються.
   * Kafka забезпечує надійне збереження повідомлень, а також їх повторну доставку в разі збою. Також вона може масштабувати обробку повідомлень для багатьох споживачів одночасно.

3. #### Веб-сервер і менеджер підключень
   * На веб-сервері існує менеджер підключень WebSocket (ConnectionManager), який управляє підключеннями клієнтів.
   * Коли користувач відкриває веб-інтерфейс, встановлюється WebSocket-з'єднання між браузером і веб-сервером.
   * Веб-сервер підключений до Kafka як споживач топіка "telegram-messages". Він слухає події (повідомлення) від Kafka через Kafka Consumer.

4. #### Передача повідомлення через WebSocket
   * Як тільки веб-сервер отримує нове повідомлення від Kafka, він використовує ConnectionManager, щоб відправити це повідомлення через WebSocket на всі активні підключення.
   * Кожен веб-клієнт, який підключений до WebSocket, отримує повідомлення миттєво після того, як воно з'являється в Kafka.
   * У результаті, користувачі веб-інтерфейсу бачать нові повідомлення в реальному часі без потреби перезавантажувати сторінку.
